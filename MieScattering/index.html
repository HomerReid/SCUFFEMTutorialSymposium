<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>First calculation: Mie scattering - BU Symposium on Open-Source CAD Tools, 10/25/2016</title>
  

  <link rel="shortcut icon" href="../scuffEM.ico">
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../css/highlight.css">

  
  <script>
    // Current page data
    var mkdocs_page_name = "MieScattering"
  </script>
  
  <script src="../js/jquery-2.1.1.min.js"></script>
  <script src="../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../js/highlight.pack.js"></script>
  <script src="../js/theme.js"></script> 
  <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
  <script src="../mathjaxhelper.js"></script>

  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">

      <p align="center"
      <a href="..">
         <img align="center" height="auto" width="100%"  
              src="../img/HeaderMedium.png"
      </a>

      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> BU Symposium on Open-Source CAD Tools, 10/25/2016</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        <ul class="current">
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="..">Outline and Agenda</a>
        
    </li>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../ImageGallery/">Image gallery</a>
        
    </li>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Overview of Integral-Equation Methods and Introduction to SCUFF-EM</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../IntegralEquations/">Integral-equation approaches to electromagnetic scattering</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../IntroToSCUFF/">Introduction to SCUFF-EM</a>
        
    </li>

        
            
    <li class="toctree-l1 current">
        <a class="current" href="./">First calculation: Mie scattering</a>
        
            <ul>
            
                <li class="toctree-l3"><a href="#exact-solution">Exact solution</a></li>
                
                    <li><a class="toctree-l4" href="#field-components-in-the-electrostatic-limit">Field components in the electrostatic limit</a></li>
                
                    <li><a class="toctree-l4" href="#power-force-and-torque-pft-versus-frequency">Power, force, and torque (PFT) versus frequency</a></li>
                
            
                <li class="toctree-l3"><a href="#solution-in-scuff-em">Solution in SCUFF-EM</a></li>
                
                    <li><a class="toctree-l4" href="#mesh-and-geometry-files">Mesh and geometry files</a></li>
                
                    <li><a class="toctree-l4" href="#calculating-dc-fields">Calculating DC fields</a></li>
                
                    <li><a class="toctree-l4" href="#calculating-pft-vs-frequency">Calculating PFT vs. frequency</a></li>
                
            
                <li class="toctree-l3"><a href="#calculation-in-buff-em">Calculation in BUFF-EM</a></li>
                
            
            </ul>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../SCUFFonAWS/">SCUFF-EM computations in the cloud</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Tutorial walkthrough 1 Plasmonics and nanoantennas</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../Nanoparticle/">Scattering and absorption by plasmonic nanoparticles</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../BowtieAntennas/">Field concentration at the hotspot of a bowtie antenna</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../PolarizationSwitchedAntennas/">Polarization-switched antennas</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Tutorial walkthrough 2 Diffraction and transmission</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../PeriodicDiffraction/">Diffraction patterns of periodic screens and particle arrays</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../SpiralArrays/">Diffraction patterns of periodic screens and particle arrays</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../PolarizationRotator/">Polarization-rotated transmission through chiral metasurfaces</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Tutorial walkthrough 3 Energy transfer, forces, and torques due to deterministic or stochastic (thermal and quantum-mechanical) sources</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../OpticalForceTorque/">Optical force and torque on asymmetric and chiral nanoparticles</a>
        
    </li>

        
    </ul>
<li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">BU Symposium on Open-Source CAD Tools, 10/25/2016</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".."><span class="SmallCaps">scuff-em</span> for photonics</a> &raquo;</li>
    
      
        
          <li>Overview of Integral-Equation Methods and Introduction to SCUFF-EM &raquo;</li>
        
      
    
    <li>First calculation: Mie scattering</li>
    <li class="wy-breadcrumbs-aside">
      
        
          <a href="https://github.com/homerreid/scuff-em/" class="icon icon-github"> Edit on GitHub</a>
        
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="first-calculations-with-scuff-em-and-buff-em-mie-scattering">First calculations with SCUFF-EM and BUFF-EM: Mie Scattering</h1>
<p>To get an initial flavor of the typical flow of
calculations in <a class="wikilink" href="../scuff-em/">scuff-em</a> and <a class="wikilink" href="../buff-em/">buff-em</a>,
calculation, let's first use these tools to solve
the textbook problem of <em>Mie scattering,</em> the scattering
of a plane wave by a homogeneous dielectric sphere.</p>
<p>![Mie Scattering image][../Images/MieScattering.png]</p>
<p>As shown in the figure, we will take the sphere
to have radius 1 <script type="math/tex">\mu</script>m and the incident field to be a
linearly-polarized plane wave traveling in the positive
<script type="math/tex">z</script> direction with magnitude <script type="math/tex">E_0</script> 
and wavevector <script type="math/tex">k=\frac{\omega}{c}.</script>
</p>
<h2 id="exact-solution">Exact solution</h2>
<p>For this problem, the full scattered fields may be expressed
exactly as a sum of vector spherical waves;
the full treatment may be found in <a href="http://homerreid.github.io/scuff-em-documentation/tex/scuffSpherical.pdf">this memo</a>
or any electromagnetism textbook.
Here we will two aspects of this solution.</p>
<h3 id="field-components-in-the-electrostatic-limit">Field components in the electrostatic limit</h3>
<p>In the low-frequency limit <script type="math/tex">\omega\to 0</script>, the problem
reduces to the textbook electrostatics problem of a
dielectric cylinder placed in a constant external
field (see, for example, <a href="http://www.wiley.com/WileyCDA/WileyTitle/productCd-047130932X.html">Jackson Chapter 4</a>).
The total electric field inside and outside the sphere
reads
%====================================================================%
<script type="math/tex; mode=display"> \vb E\sups{tot}(\vb x) = 
   \begin{dcases}
     \frac{3}{2+\epsilon\supt{DC}}E_0\vbhat{x}, \quad &|\vb x|<R 
     \\
     \vbhat E_0\vbhat{x} 
     +
     \pf{\epsilon\supt{DC}-1}{\epsilon\supt{DC}+2}\pf{R}{r}^3 E_0
     \big(3\vbhat{r} - \vbhat{x}\big), \qquad |\vb x|>R.
   \end{dcases}
</script>
%====================================================================%
The sphere acquires an electric dipole moment of strength
%====================================================================%
<script type="math/tex; mode=display"> \frac{\vb p}{\epsilon_0} = 4\pi\pf{\epsilon - 1}{\epsilon+2} R^3 E_0</script>
%====================================================================%
and the scattered field outside the sphere is just the electrostatic
field of this dipole.</p>
<h3 id="power-force-and-torque-pft-versus-frequency">Power, force, and torque (PFT) versus frequency</h3>
<p>Moving out of the low-frequency limit,</p>
<h2 id="solution-in-scuff-em">Solution in SCUFF-EM</h2>
<h3 id="mesh-and-geometry-files">Mesh and geometry files</h3>
<p>The first step
Here is a <a href="http://homerreid.github.io/scuff-em-documentation/reference/Geometries"><span class=SC>scuff-em</span> geometry file</a></p>
<h3 id="calculating-dc-fields">Calculating DC fields</h3>
<p>To confirm that the total <script type="math/tex">\vb E</script> field in the electrostatic
limit exhibits the expected pattern of spatial variation,
we'll first ask <a class="wikilink" href="../scuff-em/">scuff-em</a> to solve the problem at a
low frequency of <script type="math/tex">\omega=0.1\frac{c}{R}</script> 
(wavelength <script type="math/tex">\lambda=\frac{2\pi c}{\omega}\approx 60R</script>,
well within the electrostatic regime)
and to report <script type="math/tex">\vb E</script>-field values at a list of evaluation
points on the <script type="math/tex">x</script>-axis, whose coordinates we specify in the
form of a text file we'll call <code>EPFile.XAxis</code>, which looks like
this:</p>
<p><strong>Contents of file <code>EPFile.XAxis:</code></strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>-3.00 0.0 0.0
-2.95 0.0 0.0
...
 3.00 0.0 0.0
</pre></div>
</td></tr></table>

<p>We will use the
<a href="http://homerreid.github.io/scuff-em-documentation/Applications/scuff-scatter.md"><span class=SC>scuff-scatter</span></a>
application module to compute the scattered and total
fields at these points. Because
<a class="wikilink" href="../scuff-scatter/">scuff-scatter</a> takes a lot of command-line options
which can be unwieldy to enter by hand at the command
prompt, we'll put all the options into a little BASH script
called <a href="../RunScript.XAxis"><code>RunScript.XAxis.</code></a>
Here's an annotated version of the contents of this 
script:</p>
<p>Now run the </p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>% RunScript.Axis
  Thank you <span class="k">for</span> your support.
%
</pre></div>
</td></tr></table>

<p>This calculation, which takes 9 seconds on my laptop,
produces output files named
<code>E10Sphere_501.EPFile.scattered</code>
and
<code>E10Sphere_501.EPFile.total.</code>
These files report all cartesian components of
the <strong>E</strong> and <strong>H</strong> fields at each evaluation point
we requested (see the file header at the top
of this and all <a class="wikilink" href="../scuff-em/">scuff-em</a> output files for 
guidance on how to interpret the contents of the file).</p>
<p>Let's plot the <em>x</em> component of the total field in
<a href="http://gnuplot.sourceforge.net"><span class=SC>gnuplot</span></a>:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span> <span class="err">gnu</span><span class="k">plot</span><span class="o">&gt;</span> <span class="n">plot</span> <span class="s">&#39;E10SPhere_501.EPFile.total&#39;</span> <span class="nb">u</span> <span class="mi">1</span><span class="o">:</span><span class="mi">5</span> <span class="nb">w</span> <span class="n">lp</span> <span class="n">pt</span> <span class="mi">7</span> <span class="n">ps</span> <span class="mi">1</span><span class="o">,</span> <span class="mf">0.25</span>
</pre></div>
</td></tr></table>

<p>![Mie scattering results 1][../Images/MieScatteringFields.png]</p>
<h3 id="calculating-pft-vs-frequency">Calculating PFT vs. frequency</h3>
<h2 id="calculation-in-buff-em">Calculation in BUFF-EM</h2>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../SCUFFonAWS/" class="btn btn-neutral float-right" title="SCUFF-EM computations in the cloud"/>Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../IntroToSCUFF/" class="btn btn-neutral" title="Introduction to SCUFF-EM"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
    <!-- Copyright etc -->
    </p>
  </div>

  <a href="http://homerreid.github.io/scuff-em-documentation"> 
    <span class="SmallCaps">scuff-em</span>
  </a> /
  <a href="http://homerreid.github.io/buff-em-documentation"> 
    <span class="SmallCaps">buff-em</span>
  </a>:
  Open-source tools for photonics CAD,
  by
  <a href="http://homerreid.com">Homer Reid</a>

  <p>
  <font size=-1>
  Built with <a href="http://www.mkdocs.org">MkDocs</a> 
  using a customized theme modeled 
  after the 
  <a href="https://github.com/snide/sphinx_rtd_theme">theme</a>
  provided by <a href="https://readthedocs.org">Read the Docs</a>.
  </font>

</footer>
	  
        </div>
      </div>

    </section>

  </div>

<div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a class="icon icon-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../IntroToSCUFF/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../SCUFFonAWS/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>

</body>
</html>
